<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!--I wanted a specific font. The link below helped me. We can change it later-->
    <link href="https://fonts.googleapis.com/css2?family=Dosis&display=swap" rel="stylesheet">
	<!-- here we need to delete and use style.css for styling-->
    <style>
      body {
        background-color: black;
      }
      .header {
        background-color: grey;
        text-align: center;
        padding: 20px;
        font-family: 'Dosis', sans-serif;
        font-size: 36px;
        color: white;
      }
	    .input-container {
    display: flex;
    justify-content: center;
  }

  .input-container input {
    margin: 10px;
  }
      .welcome-message {
        text-align: center;
        font-family: 'Dosis', sans-serif;
        font-size: 24px;
        color: white;
        padding-top: 50px;
      }
      .image {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 500px;
      }
      img {
        display: block;
        margin: 0 auto;
      }
      .guestbook-form {
        text-align: center;
        padding-top: 50px;
      }
      .rss-feed {
        text-align: center;
        padding-top: 50px;
      }
.rss-feed {
  background-color: #f5f8fa;
  border-radius: 10px;
  padding: 20px;
  margin-top: 20px;
}

.rss-feed h2 {
  font-size: 24px;
  font-weight: bold;
  margin: 0 0 10px;
}

.rss-feed h3 {
  font-size: 18px;
  font-weight: bold;
  margin: 0 0 20px;
}

.feed-item {
  margin-bottom: 20px;
  list-style: none;
}

.feed-item-content {
  display: block;
  color: #1da1f2;
  font-size: 16px;
  font-weight: bold;
  text-decoration: none;
}

.feed-item-content:hover {
  text-decoration: underline;
}
.rss-feed {
  background-color: #f5f8fa;
  border-radius: 10px;
  padding: 20px;
  margin-top: 50px;
  box-shadow: 0 0 10px #222;
}

.feed-item {
  padding: 10px;
  border-bottom: 1px solid grey;
  list-style-type: none;
}

.feed-item-content {
  font-size: 1.2em;
}

.feed-item-date {
  font-size: 0.8em;
  color: white;
}

.container {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.input-container {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  margin-bottom: 20px;
}

.input-container input[type="text"],
.input-container input[type="submit"] {
  margin-right: 10px;
}

.output-container {
  border: 1px solid grey;
  width: 350px;
  border-radius: 8px;
  align-items: center
  background-color: #333333;
  padding: 5px;
  display: flex;
  margin: 0 auto;
  height: 200px;
}

#output {
  color: white;
  background-color: #333333;
  border: 2px solid grey;
  text-align: center;
  font-size: 16px;
  font-family: Arial, sans-serif;
  line-height: 1.5;
  font-weight: bold;
  padding: 10px;
}

#output a {
  color: #5bc0de;
  text-decoration: none;
  font-weight: bold;
}

#myChart {
  width: 800px;
  height: 400px;
}

.text-container {
  font-family: Arial, sans-serif;
  font-size: 16px;
  text-align: center;
  color: white;
  margin: 20px;
}

     </style>
</head>

<body>
<div class="header">TCC/eDX Data Analytics: Group 2 Stock Tracker</div>
<br>
<div class="text-container">
  <h1><p>Welcome to our website! &#128200;</p></h1>
  <p>Brought to you by Levi, Jarod, Zac and Steve</p>
</div>

<div class="text-container">
<br>
<p>.</p>
<br>
<p>.</p>
<br>
<p>.</p>
<br>
<p>.</p>
<br>
</div>
<br>

<img src="https://gifdb.com/images/high/colorful-running-nyan-cat-52txj31jpil7u350.webp" alt="Nyan Cat" width="100" height="75">
<br>
<br>
<div class="text-container">
  <h2><p>&#128640; Let's dive right in &#128640;</p></h2>
  <p>We'll compare crypo vs. nyse stocks</p>
</div>

<br>

<!--Alpha Vantage API call-->
<!--Fun fact Alpha Vantage gave me free premium academic account for high-volume API calls-->

<canvas id="myChart"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  <!--Here I am defining an array of stock symbols-->
  var symbols = ["MSFT", "AAPL", "GOOG", "HOOD", "COIN"];

  <!--I am creating an object to hold the time series data for each stock symbol-->
  var data = {};

  <!--Get the stock data using AJAX for each symbol-->
  symbols.forEach(function(symbol) {
    var xmlhttp = new XMLHttpRequest();
    var url = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY_ADJUSTED&symbol=" + symbol + "&apikey=Q9222ZCGAD5YT9BS";

    xmlhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        var timeSeries = JSON.parse(this.responseText)["Time Series (Daily)"];
        var values = [];

        <!--Extracting the values from the time series data-->
        for (var key in timeSeries) {
          if (timeSeries.hasOwnProperty(key)) {
            values.push(parseFloat(timeSeries[key]["4. close"]));
          }
        }

        <!--Storing the values in the data object-->
        data[symbol] = values;

        <!-- When we load all the data, we create the chart-->
        if (Object.keys(data).length == symbols.length) {
          var labels = Object.keys(timeSeries).slice(0, 126);

          <!-- More beautiful chart creation, this time using Chart.js-->
          var ctx = document.getElementById('myChart').getContext('2d');
          var chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: labels,
              datasets: symbols.map(function(symbol) {
                return {
                  label: symbol,
                  data: data[symbol],
                  borderColor: 'rgba(' + Math.floor(Math.random() * 256) + ', ' + Math.floor(Math.random() * 256) + ', ' + Math.floor(Math.random() * 256) + ', 1)',
                  borderWidth: 1
                };
              })
            },
            options: {
              scales: {
                xAxes: [{
                  type: 'time',
                  time: {
                    unit: 'month'
                  }
                }]
              }
            }
          });
        }
      }
    };

    xmlhttp.open("GET", url, true);
    xmlhttp.send();
  });
</script>


<br>

<!--This container calls info by entering a stock ticker-->

<br>

<div class="text-container">
  <h3><p>Explore Stock Market info using the box below!</p></h3>
  <p>Examples: <b>AAPL</b> - NVDA - <b>GOOG</b> - AMD - <b>GME</b> - BLOK - <b>AMZN</b> - MSFT</p>
</div>

<div class="input-container">
    <input id="ticker-input" type="text" placeholder="Enter stock symbol or ticker">
    <button id="submit-button" type="button">Submit</button>
</div>

<!--here is the output container, needs work but gets results-->

<div class="output-container">
  <textarea id="output" rows="10" cols="50"></textarea>
</div>

<!--This is how the input and output containers work, another beautiful API-->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
        const submitButton = document.getElementById('submit-button');
        const stockInput = document.getElementById('ticker-input');
        const output = document.getElementById('output');

        submitButton.addEventListener('click', () => {
            const ticker = stockInput.value;
            if (!ticker) {
                output.value = 'Please enter a stock symbol or ticker';
                return;
            }
            const url = `https://api.rss2json.com/v1/api.json?rss_url=https://finance.yahoo.com/rss/headline?s=${ticker}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        const stockData = data.items[0];
                        const outputText = `
                            Title: ${stockData.title}
                            Description: ${stockData.description}
                            Link: ${stockData.link}
                        `;
                        output.value = outputText;
                    } else {
                        output.value = `Error: ${data.message}`;
                    }
                })
                .catch(error => {
                    output.value = `Error: ${error}`;
                });
        });
</script>

<!--Nostalig purposes only, non-functioning for now-->

<div class="guestbook-form">
 <form action="#">
   <input type="text" placeholder="Enter your name">
   <input type="submit" value="Sign My Guestbook">
 </form>
</div>
	
<!--Here I wanted to add a RSS feed with Twitter posts with #cryptocurrency and #stockmarket hashtags to liven up the page-->
<!--But currently only display news from Investopedia. Change url:"xml" with rss.app link-->

<div class="rss-feed">
  <h2>News Feed</h2>
  <h3>What are people saying about Crypto & the US Stock Market?</h3>
  <!-- I used xml here bc it is easier to read in this case-->
  <div id="rss-feed">
    <ul id="feed-list">
      <head>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script> 
          $(document).ready(function() {
            $.ajax({
              url: "https://rss.app/feeds/MTR9pEhpM8FxiSjv.xml", 
              dataType: "xml",
              success: function(data) {
                var $xml = $(data);
                var items = [];
                $xml.find("item").each(function() {
                  var $this = $(this);
                  var title = $this.find("title").text();
                  var link = $this.find("link").text();
				  <!--I would like to add code here to include the Twitter profile pic..still working on it..-->
                  items.push("<li class='feed-item'><a href='" + link + "' class='feed-item-content'>" + title + "</a></li>");
                });
                $("#feed-list").html(items.join(""));
              }
            });
          });
        </script>
      </head>
    </ul>
  </div>
</div>

<!--I forgot to add the style formatting for the div class, so this doesn't show up at the bottom yet. Can we even copyright this?-->
<div class="footer">
 <p>Copyright &copy; 2023</p>
</div>
	
<script>
    console.log("This project was created by Levi McCleod, Zac Lau, Steve Reed and Jared Hubert. We hope you thoroughly enjoy the material we are presenting. Thank you!");
  </script>
 </body>
</html>